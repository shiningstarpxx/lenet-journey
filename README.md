# LeNet-5 深度学习入门项目

这是一个完整的LeNet-5卷积神经网络实现，专为深度学习初学者设计。项目包含了从数据加载、模型训练、评估到可视化的完整流程，并提供了丰富的分析工具来帮助理解神经网络的工作原理。

## 🚀 项目特性

### 核心功能
- **完整的LeNet-5实现** - 支持MNIST和CIFAR-10数据集
- **标准训练/测试流程** - 包含数据预处理、训练循环、验证和模型保存
- **全面的模型评估** - 准确率、混淆矩阵、分类报告等
- **网络激活可视化** - 动画展示各层激活情况
- **隐藏层特征分析** - 使用t-SNE和PCA分析网络学到的表示
- **单张图片推理** - 支持单张图片预测和批量预测

### 高级特性
- **TensorBoard集成** - 实时监控训练过程
- **模型检查点** - 自动保存最佳模型
- **错误分析** - 分析错误分类的样本
- **置信度分析** - 预测结果的置信度评估
- **可配置参数** - 灵活的超参数设置

## 📁 项目结构

```
Lenet-journey/
├── models/                 # 模型定义
│   ├── __init__.py
│   └── lenet.py           # LeNet-5网络架构
├── data/                  # 数据处理
│   ├── __init__.py
│   └── dataset.py         # 数据加载和预处理
├── config.py              # 配置文件
├── train.py               # 训练脚本
├── evaluate.py            # 评估脚本
├── inference.py           # 推理脚本
├── utils.py               # 工具函数
├── requirements.txt       # 依赖包
└── README.md             # 项目说明
```

## 🛠️ 安装和设置

### 1. 环境要求
- Python 3.7+
- PyTorch 2.0+
- CUDA (可选，用于GPU加速)

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

### 3. 目录结构
运行脚本时会自动创建以下目录：
- `data/` - 数据集存储
- `models/` - 模型保存
- `logs/` - TensorBoard日志
- `results/` - 评估结果和可视化

## 🎯 快速开始

### 1. 训练模型
```bash
# 使用MNIST数据集训练
python train.py

# 使用CIFAR-10数据集训练
# 修改config.py中的DATASET = 'CIFAR10'，然后运行
python train.py
```

### 2. 评估模型
```bash
# 评估训练好的模型
python evaluate.py
```

### 3. 单张图片推理
```bash
# 预测单张图片
python inference.py --image path/to/your/image.jpg

# 使用CIFAR-10模型预测
python inference.py --image path/to/your/image.jpg --dataset CIFAR10
```

### 4. 批量预测
```bash
python inference.py --batch image1.jpg image2.jpg image3.jpg
```

## 📊 功能详解

### 网络架构
LeNet-5包含以下层：
- **Conv1**: 6个5×5卷积核，ReLU激活
- **Pool1**: 2×2最大池化
- **Conv2**: 16个5×5卷积核，ReLU激活  
- **Pool2**: 2×2最大池化
- **FC1**: 120个神经元，ReLU激活
- **FC2**: 84个神经元，ReLU激活
- **FC3**: 10个神经元（输出层）

### 训练过程
- 使用SGD优化器，动量0.9
- 学习率调度：每10个epoch衰减0.1
- 支持数据增强（CIFAR-10）
- 自动保存最佳模型

### 评估指标
- 测试准确率
- 混淆矩阵
- 每类别的精确率、召回率、F1分数
- 错误分类样本分析

### 可视化功能
1. **训练曲线** - 损失和准确率变化
2. **混淆矩阵** - 分类结果热力图
3. **预测结果** - 样本预测对比
4. **网络激活** - 各层激活情况动画
5. **特征分析** - 隐藏层特征的t-SNE可视化

## ⚙️ 配置选项

在`config.py`中可以调整以下参数：

```python
# 数据配置
DATASET = 'MNIST'          # 数据集选择
BATCH_SIZE = 64            # 批次大小
NUM_WORKERS = 4            # 数据加载线程数

# 训练配置
EPOCHS = 20                # 训练轮数
LEARNING_RATE = 0.001      # 学习率
MOMENTUM = 0.9             # 动量
WEIGHT_DECAY = 1e-4        # 权重衰减

# 可视化配置
SAVE_PLOTS = True          # 保存图表
SHOW_ACTIVATIONS = True    # 显示激活动画
ANIMATION_FPS = 2          # 动画帧率
```

## 📈 预期结果

### MNIST数据集
- 训练准确率: ~99%
- 测试准确率: ~98%
- 训练时间: ~5分钟 (CPU) / ~1分钟 (GPU)

### CIFAR-10数据集
- 训练准确率: ~70%
- 测试准确率: ~65%
- 训练时间: ~15分钟 (CPU) / ~3分钟 (GPU)

## 🔍 深入分析

### 网络激活分析
项目提供了详细的网络激活分析功能：

1. **逐层激活可视化** - 展示每个卷积层和全连接层的激活模式
2. **激活动画** - 动态展示不同样本在网络中的激活过程
3. **特征图分析** - 可视化卷积层学到的特征

### 隐藏层特征分析
- **t-SNE降维** - 将高维特征映射到2D空间
- **PCA分析** - 主成分分析
- **类别分离度** - 分析不同类别在特征空间中的分布

### 错误分析
- 识别容易混淆的类别
- 分析低置信度预测
- 可视化错误分类样本

## 🎓 学习价值

这个项目特别适合：
- **深度学习初学者** - 理解CNN的基本原理
- **PyTorch学习者** - 掌握PyTorch的使用方法
- **计算机视觉入门** - 学习图像分类任务
- **模型分析实践** - 理解网络内部工作机制

## 🚨 常见问题

### Q: 如何切换到GPU训练？
A: 确保安装了CUDA版本的PyTorch，代码会自动检测并使用GPU。

### Q: 训练过程中如何监控？
A: 使用TensorBoard查看训练过程：
```bash
tensorboard --logdir=logs
```

### Q: 如何调整网络结构？
A: 修改`models/lenet.py`中的网络定义，或创建新的网络类。

### Q: 支持其他数据集吗？
A: 可以扩展`data/dataset.py`来支持其他数据集。

## 📚 扩展建议

1. **数据增强** - 添加更多数据增强技术
2. **网络架构** - 尝试不同的网络结构
3. **优化器** - 实验不同的优化算法
4. **正则化** - 添加Dropout、BatchNorm等
5. **超参数调优** - 使用网格搜索或贝叶斯优化

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 📄 许可证

MIT License

---

**开始你的深度学习之旅吧！** 🎉
